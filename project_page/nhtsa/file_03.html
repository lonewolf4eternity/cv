<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../../css/project_details.css">
    <title>Dashboard</title>
    <script type="text/javascript">
        document.addEventListener (
            'contextmenu', function (e) {
                e.preventDefault();
            }
        );
    </script>
    <script type="text/javascript">
        document.addEventListener (
            'keydown', function (e) {
                if (
                    e.ctrlKey && e.keyCode === 'u'
                ) {
                    e.preventDefault();
                }
            }
        );
    </script>
    <script type="text/javascript">
        document.onkeydown = function (e) {
            if (
                e.ctrlKey && (
                    e.keyCode === 67 ||
                    e.keyCode === 86 ||
                    e.keyCode === 85 ||
                    e.keyCode === 117
                )
            ) {
                return false;
            } else {
                return true;
            }
        };
    </script>
</head>
<body>
    <header>
        <button class="x-btn" id="close-dashboard-btn">X</button>
        <a href="../nhtsa/file_00.html"><button class="all-btn">Dashboard</button></a>
        <a href="../nhtsa/file_01.html"><button class="all-btn">Dataset</button></a>
        <a href="../nhtsa/file_02.html"><button class="all-btn">Details</button></a>
        <a href="../nhtsa/file_03.html"><button class="all-btn">SQL Code</button></a>
    </header>
    <div class="content">
        <h1>SQL Code</h1>
    </div>
    <div class="content">
        <h2>NHTSA Project</h2>
    </div>
    <div class="content" id="python">
        <code>
            <span style="color: aquamarine;">/*&nbsp;&nbsp;&nbsp;CASE</span>
            <br>
            <span style="color: aquamarine;">NHTSA adalah salah satu departemen pemerintah di Amerika Serikat yang fokus terhadap mengurangi angka kecelakaan lalu lintas di jalan raya. Saat ini NHTSA sedang menggodok regulasi baru yang akan diterapkan tahun depan. Saat ini perusahaan diminta untuk menganalisa data yang dikumpulkan selama tahun 2021. Data ini adalah data lengkap tentang kecelakaan yang terjadi selama tahun 2021.</span>
            <br>
            <br>
            <span style="color: aquamarine;">Tujuan Analisa Data:</span>
            <br>
            <span style="color: aquamarine;">Tujuan utama adalah untuk memberikan sejumlah rekomendasi tentang cara mengurangi angka kecelakaan di jalan raya. Untuk melakukan ini, pertama-tama Anda perlu mengidentifikasi data berikut:</span>
            <ol style="color: aquamarine;">
                <li>Kondisi yang meningkatkan risiko kecelakaan.</li>
                <li>10 teratas negara bagian di mana kecelakaan paling banyak terjadi.</li>
                <li>Jumlah rerata kecelakaan yang terjadi setiap jam.</li>
                <li>Persentase kecelakaan yang disebabkan oleh pengemudi yang mabuk.</li>
                <li>Persentasi kecelakaan di daerah pedesaan dan perkotaan.</li>
                <li>Jumlah kecelakaan berdasarkan hari.</li>
                <li>Tentukan parameter lain.</li>
            </ol>
            <span style="color: aquamarine;">*/</span>
            <br>
            <br>
            <span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;load table from crash.sql</span>
            <br>
            <span style="color: red;">SELECT </span><span style="color: rgb(255, 153, 0);"> * </span><span style="color: red;"> FROM </span> crash <span style="color: rgb(255, 153, 0);"> ; </span>
            <br>
            <br>
            <span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;load timezone America</span>
            <br>
            <span style="color: red;">SELECT </span><span style="color: rgb(255, 153, 0);"> * </span><span style="color: red;"> FROM </span> pg_timezone_names <span style="color: rgb(255, 153, 0);"> ( ) </span>
            <br>
            <span style="color: red;">WHERE </span> "name" <span style="color: red;"> LIKE </span><span style="color: yellow;"> 'America/%' </span><span style="color: rgb(255, 153, 0);"> ; </span>
            <br>
            <br>
            <span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;synchronize timezone with creating new table</span>
            <br>
            <span style="color: red;">DROP TABLE IF EXISTS </span> crash_2021 <span style="color: rgb(255, 153, 0);"> ; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;menghapus table jika sudah ada</span>
            <br>
            <span style="color: red;">CREATE TABLE </span> crash_2021 <span style="color: red;"> AS </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;membuat table baru</span>
            <br>
            <span style="color: red;">WITH </span> data_validation <span style="color: red;"> AS </span><span style="color: rgb(255, 153, 0);"> ( </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;membuat validasi data</span>
                <br>
                <span style="padding-left: 30px;color: red;">SELECT </span><span style="color: rgb(255, 153, 0);"> * , </span> timestamp_of_crash <span style="color: red;"> AT </span><span style="color: cornflowerblue;"> TIME ZONE </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: aquamarine;"> --&nbsp;&nbsp;&nbsp;mengubbah waktu berdasarkan zona</span>
                <br>
                <span style="padding-left: 30px; color: red;">CASE </span>
                <br>
                <span style="padding-left: 30px; color: red;">WHEN </span> state_name <span style="color: red;"> IN </span><span style="color: rgb(255, 153, 0);"> ( </span>
                    <br>
                    <span style="padding-left: 60px; color: yellow;">'Alabama' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Arkansas' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Illionis' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Iowa' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Kansas' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Louisiana' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Minnesota' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Mississipi' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Missouri' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Nebraska' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'North Dakota' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Oklahoma' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'South Dakota' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Tennesse' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Texas' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Wisconsin' </span>
                <br>
                <span style="padding-left: 30px; color: rgb(255, 153, 0);">)</span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'America/Chicago' </span>
                <br>
                <span style="padding-left: 30px; color: red;">WHEN </span> state_name <span style="color: red;"> IN </span><span style="color: rgb(255, 153, 0);"> ( </span>
                    <br>
                    <span style="padding-left: 60px; color: yellow;">'Colorado' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Montana' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'New Mexico' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Utah' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Wyoming' </span>
                <br>
                <span style="padding-left: 30px; color: rgb(255, 153, 0);">)</span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'America/Denver' </span>
                <br>
                <span style="padding-left: 30px; color: red;">WHEN </span> state_name <span style="color: red;"> IN </span><span style="color: rgb(255, 153, 0);"> ( </span>
                    <br>
                    <span style="padding-left: 60px; color: yellow;">'Connecticut' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Delaware' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'District' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Florida' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Georgia' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Indiana' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Kentucky' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Maine' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Maryland' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Massachusetts' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Michigan' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'New Hampshire' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'New Jersey' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'New York' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'North Carolina' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Ohio' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Pennsylvania' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Rhode Island' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'South Carolina' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Vermont' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Virginia' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'West Virginia' </span>
                <br>
                <span style="padding-left: 30px; color: rgb(255, 153, 0);">)</span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'America/New_York' </span>
                <br>
                <span style="padding-left: 30px; color: red;">WHEN </span> state_name <span style="color: red;"> IN </span><span style="color: rgb(255, 153, 0);"> ( </span>
                    <br>
                    <span style="padding-left: 60px; color: yellow;">'California' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Nevada' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Oregon' </span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> 'Washington' </span>
                <br>
                <span style="padding-left: 30px; color: rgb(255, 153, 0);">)</span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'America/Los_Angeles' </span>
                <br>
                <span style="padding-left: 30px; color: red;">WHEN </span> state_name <span style="color: red;"> IN </span><span style="color: rgb(255, 153, 0);"> ( </span><span style="color: yellow;"> 'Idaho' </span><span style="color: rgb(255, 153, 0);"> ) </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'America/Boise' </span>
                <br>
                <span style="padding-left: 30px; color: red;">WHEN </span> state_name <span style="color: red;"> IN </span><span style="color: rgb(255, 153, 0);"> ( </span><span style="color: yellow;"> 'Alaska' </span><span style="color: rgb(255, 153, 0);"> ) </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'America/Anchoorage' </span>
                <br>
                <span style="padding-left: 30px; color: red;">WHEN </span> state_name <span style="color: red;"> IN </span><span style="color: rgb(255, 153, 0);"> ( </span><span style="color: yellow;"> 'Hawaii' </span><span style="color: rgb(255, 153, 0);"> ) </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Pacific/Honolulu' </span>
                <br>
                <span style="padding-left: 30px; color: red;">ELSE </span><span style="color: yellow;"> 'UTC' </span>
                <br>
                <span style="padding-left: 30px; color: red;">END AS </span> real_timezone
                <br>
                <span style="padding-left: 30px; color: red;">FROM </span> crash
            <br>
            <span style="color: rgb(255, 153, 0);">)</span><span style="color: red;"> SELECT </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;memilih kolom yang akan ditampilkan</span>
            <br>
            consecutive_nummber<span style="color: rgb(255, 153, 0);"> , </span> state_name <span style="color: rgb(255, 153, 0);"> , </span> city_name <span style="color: rgb(255, 153, 0);"> , </span> land_use_name <span style="color: rgb(255, 153, 0);"> , </span>
            <br>
            CONCAT<span style="color: rgb(255, 153, 0);"> ( </span>
                <br>
                <span style="padding-left: 30px;">type_of_intersection_name</span><span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> ' - ' </span><span style="color: rgb(255, 153, 0);"> , </span> light_condition_name <span style="color: rgb(255, 153, 0);"> , </span><span style="color: yellow;"> ' - ' </span><span style="color: rgb(255, 153, 0);"> , </span> atmospheric_condition_1_name
            <br>
            <span style="color: rgb(255, 153, 0);">) </span><span style="color: red;"> AS </span> factor_condition<span style="color: rgb(255, 153, 0);">, </span>
            <br>
            number_of_fatalities<span style="color: rgb(255, 153, 0);"> , </span> number_of_drunk_drivers <span style="color: rgb(255, 153, 0);"> , </span> real_timezone <span style="color: rgb(255, 153, 0);"> , </span>
            <br>
            <span style="color: red;">EXTRACT </span><span style="color: rgb(255, 153, 0);"> ( </span><span style="color: red;">YEAR FROM </span> real_timezone <span style="color: rgb(255, 153, 0);">) </span><span style="color: red;"> AS </span> crash_year <span style="color: rgb(255, 153, 0);"> , </span>
            <br>
            TO_CHAR <span style="color: rgb(255, 153, 0);"> ( </span> real_timezone <span style="color: rgb(255, 153, 0);">, </span><span style="color: yellow;"> 'Month' </span><span style="color: rgb(255, 153, 0);">) </span><span style="color: red;"> AS </span> crash_month<span style="color: rgb(255, 153, 0);">, </span>
            <br>
            <span style="color: red;">CASE</span>
            <br>
            <span style="color: red;">WHEN EXTRACT </span><span style="color: rgb(255, 153, 0);">( </span> DOW <span style="color: red;"> FROM </span> real_timezone <span style="color: rgb(255, 153, 0);">) = </span><span style="color: aquamarine;"> 0 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Minggu' </span>
            <br>
            <span style="color: red;">WHEN EXTRACT </span><span style="color: rgb(255, 153, 0);">( </span> DOW <span style="color: red;"> FROM </span> real_timezone <span style="color: rgb(255, 153, 0);">) = </span><span style="color: aquamarine;"> 1 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Senin' </span>
            <br>
            <span style="color: red;">WHEN EXTRACT </span><span style="color: rgb(255, 153, 0);">( </span> DOW <span style="color: red;"> FROM </span> real_timezone <span style="color: rgb(255, 153, 0);">) = </span><span style="color: aquamarine;"> 2 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Selasa' </span>
            <br>
            <span style="color: red;">WHEN EXTRACT </span><span style="color: rgb(255, 153, 0);">( </span> DOW <span style="color: red;"> FROM </span> real_timezone <span style="color: rgb(255, 153, 0);">) = </span><span style="color: aquamarine;"> 3 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Rabu' </span>
            <br>
            <span style="color: red;">WHEN EXTRACT </span><span style="color: rgb(255, 153, 0);">( </span> DOW <span style="color: red;"> FROM </span> real_timezone <span style="color: rgb(255, 153, 0);">) = </span><span style="color: aquamarine;"> 4 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Kamis' </span>
            <br>
            <span style="color: red;">WHEN EXTRACT </span><span style="color: rgb(255, 153, 0);">( </span> DOW <span style="color: red;"> FROM </span> real_timezone <span style="color: rgb(255, 153, 0);">) = </span><span style="color: aquamarine;"> 5 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Jumat' </span>
            <br>
            <span style="color: red;">WHEN EXTRACT </span><span style="color: rgb(255, 153, 0);">( </span> DOW <span style="color: red;"> FROM </span> real_timezone <span style="color: rgb(255, 153, 0);">) = </span><span style="color: aquamarine;"> 6 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Sabtu' </span>
            <br>
            <span style="color: red;">END AS </span> crash_day <span style="color: rgb(255, 153, 0);">, </span>
            <br>
            <span style="color: red;">EXTRACT </span><span style="color: rgb(255, 153, 0);">( </span><span style="color: red;"> HOUR FROM </span> real_timezone <span style="color: rgb(255, 153, 0);">) </span><span style="color: red;"> AS </span> crash_hour_time
            <br>
            <span style="color: red;">FROM </span> data_validation
            <br>
            <span style="color: red;">WHERE EXTRACT </span><span style="color: rgb(255, 153, 0);">( </span><span style="color: red;"> YEAR FROM </span> real_timezone <span style="color: rgb(255, 153, 0);">) = </span><span style="color: yellow;"> '2021' </span>
            <br>
            <span style="color: red;">ORDER BY </span> consecutive_nummber_time <span style="color: rgb(255, 153, 0);">; </span>
            <br>
            <br>
            <span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;menampilkan tabel crash_2021</span>
            <br>
            <span style="color: red;">SELECT </span><span style="color: rgb(255, 153, 0);"> * </span><span style="color: red;"> FROM </span> crash_2021 <span style="color: rgb(255, 153, 0);">; </span>
            <br>
            <br>
            <span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;&nbsp;tingkat kecelakaan berdasarkan faktor kondisi</span>
            <br>
            <span style="color: red;">SELECT </span> factor_condition <span style="color: rgb(255, 153, 0);"> , </span>
            <br>
            <span style="color: red;">COUNT </span><span style="color: rgb(255, 153, 0);"> ( * ) </span><span style="color: red;"> AS </span> jumlah_kecelakaan
            <br>
            <span style="color: red;">FROM </span> crash_2021
            <br>
            <span style="color: red;">GROUP BY </span> factor_condition
            <br>
            <span style="color: red;">ORDEr BY </span> jumlah_kecelakaan <span style="color: red;"> DESC </span>
            <br>
            <span style="color: red;">LIMIT </span><span style="color: aquamarine;"> 10 </span><span style="color: rgb(255, 153, 0);"> ; </span>
            <br>
            <br>
            <span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;2.&nbsp;&nbsp;&nbsp;10 negara bagian dengan tingkat kecelakaan tertinggi.</span>
            <br>
            <span style="color: red;">SELECT </span> state_name <span style="color: rgb(255, 153, 0);"> , </span>
            <br>
            <span style="color: red;">COUNT </span><span style="color: rgb(255, 153, 0);"> ( * ) </span><span style="color: red;"> AS </span> jumlah_kecelakaan
            <br>
            <span style="color: red;">FROM </span> crash_2021
            <br>
            <span style="color: red;">GROUP BY </span> state_name 
            <br>
            <span style="color: red;">ORDEr BY </span> jumlah_kecelakaan <span style="color: red;"> DESC </span>
            <br>
            <span style="color: red;">LIMIT </span><span style="color: aquamarine;"> 10 </span><span style="color: rgb(255, 153, 0);"> ; </span>
            <br>
            <br>
            <span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;3.&nbsp;&nbsp;&nbsp;rata-rata kecelakaan per jam</span>
            <br>
            <span style="color: red;">SELECT </span> crash_hour_time <span style="color: rgb(255, 153, 0);"> , </span>
            <br>
            <span style="color: red;">COUNT </span><span style="color: rgb(255, 153, 0);"> (*) </span><span style="color: red;"> AS </span> jumlah_kecelakaan <span style="color: rgb(255, 153, 0);">, </span>
            <br>
            ROUND <span style="color: rgb(255, 153, 0);"> (</span>
                <br>
                <span style="padding-left: 30px; color: red;">COUNT </span><span style="color: rgb(255, 153, 0);"> (*) / </span><span style="color: aquamarine;"> 365.0 </span>
            <br>
            <span style="color: rgb(255, 153, 0);">) </span><span style="color: red;"> AS </span> average_per_hour
            <br>
            <span style="color: red;">FROM </span> crash_2021
            <br>
            <span style="color: red;">GROUP BY </span> crash_hour_time
            <br>
            <span style="color: red;">ORDEr BY </span> crash_hour_time <span style="color: rgb(255, 153, 0);"> ; </span>
            <br>
            <br>
            <span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;4.&nbsp;&nbsp;&nbsp;drunk driver percentage of accident</span>
            <br>
            <span style="color: red;">SELECT </span> number_of_drunk_drivers <span style="color: rgb(255, 153, 0);"> , </span>
            <br>
            <span style="color: red;">COUNT </span><span style="color: rgb(255, 153, 0);"> (*) </span><span style="color: red;"> AS </span> total_drunk_driver <span style="color: rgb(255, 153, 0);">, </span>
            <br>
            <span style="color: red;">CASE</span>
            <br>
            <span style="color: red;">WHEN </span> number_of_drunk_drivers <span style="color: rgb(255, 153, 0);"> = </span><span style="color: aquamarine;"> 0 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Not Drunk' </span>
            <br>
            <span style="color: red;">WHEN </span> number_of_drunk_drivers <span style="color: rgb(255, 153, 0);"> = </span><span style="color: aquamarine;"> 1 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Slightly Drunk' </span>
            <br>
            <span style="color: red;">WHEN </span> number_of_drunk_drivers <span style="color: rgb(255, 153, 0);"> = </span><span style="color: aquamarine;"> 2 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Moderate Drunk' </span>
            <br>
            <span style="color: red;">WHEN </span> number_of_drunk_drivers <span style="color: rgb(255, 153, 0);"> = </span><span style="color: aquamarine;"> 3 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Heavy Drunk' </span>
            <br>
            <span style="color: red;">WHEN </span> number_of_drunk_drivers <span style="color: rgb(255, 153, 0);"> = </span><span style="color: aquamarine;"> 4 </span><span style="color: red;"> THEN </span><span style="color: yellow;"> 'Very Heavy Drunk' </span>
            <br>
            <span style="color: red;">ELSE </span><span style="color: yellow;"> 'Unknown'</span>
            <br>
            <span style="color: red;">END AS </span> drunk_status <span style="color: rgb(255, 153, 0);">,</span>
            <br>
            ROUND <span style="color: rgb(255, 153, 0);"> (</span>
                <br>
                <span style="padding-left: 30px; color: rgb(255, 153, 0);">(</span>
                    <br>
                    <span style="padding-left: 60px; color: red;">COUNT </span><span style="color: rgb(255, 153, 0);"> (*) * </span><span style="color: aquamarine;"> 100.0 </span><span style="color: rgb(255, 153, 0);"> / (</span>
                        <br>
                        <span style="padding-left: 90px; color: red;">SUM </span><span style="color: rgb(255, 153, 0);"> ( </span><span style="color: red;"> COUNT </span><span style="color: rgb(255, 153, 0);"> ( * ) )</span><span style="color: red;"> OVER </span><span style="color: rgb(255, 153, 0);"> ( ) </span>
                    <br>
                    <span style="padding-left: 60px; color: rgb(255, 153, 0);">)</span>
                <br>
                <span style="padding-left: 30px; color: rgb(255, 153, 0);">) , </span><span style="color: aquamarine;"> 3 </span>
            <br>
            <span style="color: rgb(255, 153, 0);">) </span><span style="color: red;"> AS </span> crash_percent_drunk
            <br>
            <span style="color: red;">FROM </span> crash_2021
            <br>
            <span style="color: red;">GROUP BY </span> number_of_drunk_drivers
            <br>
            <span style="color: red;">ORDER BY </span> number_of_drunk_drivers <span style="color: red;"> ASC </span><span style="color: rgb(255, 153, 0);"> ; </span>
            <br>
            <br>
            <span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;5.&nbsp;&nbsp;&nbsp;jummlah kecelakaan di pedesaan atau di perkotaan</span>
            <br>
            <span style="color: red;">SELECT </span> land_use_name <span style="color: rgb(255, 153, 0);"> , </span>
            <br>
            <span style="color: red;">COUNT </span><span style="color: rgb(255, 153, 0);"> ( * ) </span><span style="color: red;"> AS </span> jumlah_kecelakaan <span style="color: rgb(255, 153, 0);"> , </span>
            <br>
            ROUND <span style="color: rgb(255, 153, 0);"> ( </span>
                <br>
                <span style="padding-left: 30px; color: rgb(255, 153, 0);">(</span>
                    <br>
                    <span style=" padding-left: 60px; color: red;">COUNT </span><span style="color: rgb(255, 153, 0);"> ( * ) * </span><span style="color: aquamarine;"> 100.0 </span><span style="color: rgb(255, 153, 0);"> / ( </span>
                        <br>
                        <span style="padding-left: 90px; color: red;">SUM </span><span style="color: rgb(255, 153, 0);"> ( </span><span style="color: red;"> COUNT </span><span style="color: rgb(255, 153, 0);"> ( * ) ) </span><span style="color: red;"> OVER </span><span style="color: rgb(255, 153, 0);"> ( ) </span>
                    <br>
                    <span style="padding-left: 60px; color: rgb(255, 153, 0);">)</span>
                <br>
                <span style="padding-left: 30px; color: rgb(255, 153, 0);"> ) , </span><span style="color: aquamarine;"> 3 </span>
            <br>
            <span style="color: rgb(255, 153, 0);">)</span><span style="color: red;"> AS </span> percentage
            <br>
            <span style="color: red;">FROM </span> crash_2021
            <br>
            <span style="color: red;">GROUP BY </span> land_use_name
            <br>
            <span style="color: red;">ORDER BY </span> jumlah_kecelakaan <span style="color: red;"> DESC </span><span style="color: rgb(255, 153, 0);">;</span>
            <br>
            <br>
            <span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;6.&nbsp;&nbsp;&nbsp;jumlah kecelakaan setiap hari</span>
            <br>
            <span style="color: red;">SELECT </span> crash_day <span style="color: rgb(255, 153, 0);"> , </span>
            <br>
            <span style="color: red;">COUNT </span><span style="color: rgb(255, 153, 0);"> ( * ) </span><span style="color: red;"> AS </span> jumlah_kecelakaan
            <br>
            <span style="color: red;">FROM </span> crash_2021
            <br>
            <span style="color: red;">GROUP BY </span> crash_day
            <br>
            <span style="color: red;">ORDER BY </span>
            <br>
            <span style="color: red;">CASE </span>
            <br>
            <span style="color: red;">WHEN </span> crash_day <span style="color: rgb(255, 153, 0);"> = </span><span style="color: yellow;"> 'Senin' </span><span style="color: red;"> THEN </span><span style="color: aquamarine;"> 0 </span>
            <br>
            <span style="color: red;">WHEN </span> crash_day <span style="color: rgb(255, 153, 0);"> = </span><span style="color: yellow;"> 'Selasa' </span><span style="color: red;"> THEN </span><span style="color: aquamarine;"> 1 </span>
            <br>
            <span style="color: red;">WHEN </span> crash_day <span style="color: rgb(255, 153, 0);"> = </span><span style="color: yellow;"> 'Rabu' </span><span style="color: red;"> THEN </span><span style="color: aquamarine;"> 2 </span>
            <br>
            <span style="color: red;">WHEN </span> crash_day <span style="color: rgb(255, 153, 0);"> = </span><span style="color: yellow;"> 'Kamis' </span><span style="color: red;"> THEN </span><span style="color: aquamarine;"> 3 </span>
            <br>
            <span style="color: red;">WHEN </span> crash_day <span style="color: rgb(255, 153, 0);"> = </span><span style="color: yellow;"> 'Jumat' </span><span style="color: red;"> THEN </span><span style="color: aquamarine;"> 4 </span>
            <br>
            <span style="color: red;">WHEN </span> crash_day <span style="color: rgb(255, 153, 0);"> = </span><span style="color: yellow;"> 'Sabtu' </span><span style="color: red;"> THEN </span><span style="color: aquamarine;"> 5 </span>
            <br>
            <span style="color: red;">WHEN </span> crash_day <span style="color: rgb(255, 153, 0);"> = </span><span style="color: yellow;"> 'Minggu' </span><span style="color: red;"> THEN </span><span style="color: aquamarine;"> 6 </span>
            <br>
            <span style="color: red;">END </span><span style="color: rgb(255, 153, 0);">;</span>
            <br>
            <br>
            <span style="color: aquamarine;">--&nbsp;&nbsp;&nbsp;7.&nbsp;&nbsp;&nbsp;jumlah kecelakaan berdasarkan faktor eksternal</span>
            <br>
            <span style="color: red;">SELECT </span> state_name <span style="color: rgb(255, 153, 0);"> , </span> land_use_name <span style="color: rgb(255, 153, 0);"> , </span> factor_condition <span style="color: rgb(255, 153, 0);"> , </span> crash_day <span style="color: rgb(255, 153, 0);"> , </span> crash_hour_time <span style="color: rgb(255, 153, 0);"> , </span> 
            <br>
            <span style="color: red;">COUNT </span><span style="color: rgb(255, 153, 0);"> ( * ) </span> jumlah_kecelakaan
            <br>
            <span style="color: red;">FROM </span> crash_2021
            <br>
            <span style="color: red;">GROUP BY </span> state_name <span style="color: rgb(255, 153, 0);"> , </span> land_use_name  <span style="color: rgb(255, 153, 0);"> , </span> factor_condition  <span style="color: rgb(255, 153, 0);"> , </span> crash_day  <span style="color: rgb(255, 153, 0);"> , </span> crash_hour_time
            <br>
            <span style="color: red;">ORDER BY </span> jumlah_kecelakaan <span style="color: red;"> DESC </span>
            <br>
            <span style="color: red;">LIMIT </span><span style="color: aquamarine;"> 10 </span><span style="color: rgb(255, 153, 0);"> ; </span>
        </code>
    </div>
    <script src="../../../js/dashboard.js"></script>
</body>
</html>